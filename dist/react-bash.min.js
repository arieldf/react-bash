!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):"object"==typeof exports?exports.ReactBash=t(require("react")):e.ReactBash=t(e.React)}(this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.BashUtil=t.BashConst=void 0;var a=r(5),i=o(a),s=r(2),c=n(s),u=r(1),l=n(u);t.default=i.default,t.BashConst=l,t.BashUtil=c},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.IS_SERVER="undefined"==typeof window;t.BACK_REGEX=/\/?\.?[\w-_]+\/\.\./,t.Errors={COMMAND_NOT_FOUND:"-bash: $1: command not found",FILE_EXISTS:"mkdir: $1: File exists",NO_SUCH_FILE:"-bash: cd: $1: No such file or directory",NOT_A_DIRECTORY:"-bash: cd: $1: Not a directory",IS_A_DIRECTORY:"cat: $1: Is a directory"},t.EnvVariables={TERM_PROGRAM:"ReactBash.app",TERM:"reactbash-256color",TERM_PROGRAM_VERSION:"1.4.3",TERM_SESSION_ID:"w0t0p1:37842145-87D9-4768-BEC3-3684BAF3A964",USER:function(e){return e.settings.user.username},PATH:"/",PWD:function(e){return"/"+e.cwd},LANG:function(){return r?"en_US.UTF-8":navigator.language.replace("-","_")+".UTF-8"},HOME:"/",LOGNAME:function(e){return e.settings.user.username},OLDPWD:"/"}},function(e,t,r){"use strict";function n(e,t){return e[0]===t&&(e=e.substr(1)),e[e.length-1]===t&&(e=e.substr(0,e.length-1)),e}function o(e,t,r){return Object.assign({},e,{error:!0,history:e.history.concat({value:t.replace("$1",r)})})}function a(e,t){if(""===e)return t;e=n(e,"/");for(var r=""+(t?t+"/":"")+e;r.match(l.BACK_REGEX);)r=r.replace(l.BACK_REGEX,"");return n(r,"/")}function i(e,t){var r=t.split("/");if(!r[0])return{dir:e};for(var n=e,o=0;r.length>o;){var a=r[o],i=n[a];if(!i||"object"!==(void 0===i?"undefined":u(i)))return{err:l.Errors.NO_SUCH_FILE.replace("$1",t)};if(i.hasOwnProperty("content"))return{err:l.Errors.NOT_A_DIRECTORY.replace("$1",t)};n=i,o++}return{dir:n}}function s(e){return Object.keys(l.EnvVariables).reduce(function(t,r){var n=l.EnvVariables[r];return t[r]="function"==typeof n?n(e):n,t},{})}function c(e){return void 0!==e.content}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.trim=n,t.appendError=o,t.extractPath=a,t.getDirectoryByPath=i,t.getEnvVariables=s,t.isFile=c;var l=r(1)},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);e.length>t;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=t.rm=t.whoami=t.printenv=t.echo=t.pwd=t.cd=t.mkdir=t.cat=t.ls=t.clear=t.help=void 0;var a=r(2),i=n(a),s=r(1),c=["clear","ls","cat","mkdir","cd","pwd","echo","printenv","whoami","rm","sleep"];t.help={exec:function(e){var t;return Object.assign({},e,{history:(t=e.history).concat.apply(t,[{value:"React-bash:"},{value:"These shell commands are defined internally.  Type 'help' to see this list."}].concat(o(c.map(function(e){return{value:e}}))))})}},t.clear={exec:function(e){return Object.assign({},e,{history:[]})}},t.ls={exec:function(e,t){var r=t.flags,n=t.args,o=n[0]||"",a=i.extractPath(o,e.cwd),s=i.getDirectoryByPath(e.structure,a),c=s.err,u=s.dir;if(c)return i.appendError(e,c,o);var l=Object.keys(u);return r.a||(l=l.filter(function(e){return"."!==e[0]})),r.l?Object.assign({},e,{history:e.history.concat(l.map(function(e){return{value:e}}))}):Object.assign({},e,{history:e.history.concat({value:l.join(" ")})})}},t.cat={exec:function(e,t){var r=t.args,n=r[0],o=n.split("/"),a=o.pop(),c=i.extractPath(o.join("/"),e.cwd),u=i.getDirectoryByPath(e.structure,c),l=u.err,f=u.dir;return l?i.appendError(e,l,n):f[a]?f[a].hasOwnProperty("content")?Object.assign({},e,{history:e.history.concat({value:f[a].content})}):i.appendError(e,s.Errors.IS_A_DIRECTORY,n):i.appendError(e,s.Errors.NO_SUCH_FILE,n)}},t.mkdir={exec:function(e,t){var r=t.args,n=r[0],o=n.split("/"),a=o.pop(),c=i.extractPath(o.join("/"),e.cwd),u=JSON.parse(JSON.stringify(e.structure)),l=i.getDirectoryByPath(u,c),f=l.dir;return f[a]?i.appendError(e,s.Errors.FILE_EXISTS,n):(f[a]={},Object.assign({},e,{structure:u}))}},t.cd={exec:function(e,t){var r=t.args,n=r[0];if(!n||"/"===n)return Object.assign({},e,{cwd:""});var o=i.extractPath(n,e.cwd),a=i.getDirectoryByPath(e.structure,o),s=a.err;return s?i.appendError(e,s,n):Object.assign({},e,{cwd:o})}},t.pwd={exec:function(e){var t="/"+e.cwd;return Object.assign({},e,{history:e.history.concat({value:t})})}},t.echo={exec:function(e,t){var r=t.input,n=5,o=i.getEnvVariables(e),a=r.slice(n).replace(/(\$\w+)/g,function(e){return o[e.slice(1)]||""});return Object.assign({},e,{history:e.history.concat({value:a})})}},t.printenv={exec:function(e){var t=i.getEnvVariables(e),r=Object.keys(t).map(function(e){return{value:e+"="+t[e]}});return Object.assign({},e,{history:e.history.concat(r)})}},t.whoami={exec:function(e){var t=e.settings.user.username;return Object.assign({},e,{history:e.history.concat({value:t})})}},t.rm={exec:function(e,t){var r=t.flags,n=t.args,o=n[0],a=o.split("/"),c=a.pop(),u=i.extractPath(a.join("/"),e.cwd),l=JSON.parse(JSON.stringify(e.structure)),f=i.getDirectoryByPath(l,u),p=f.dir;return p[c]?i.isFile(p[c])||r.r||r.R?(delete p[c],Object.assign({},e,{structure:l})):i.appendError(e,s.Errors.IS_A_DIRECTORY,o):i.appendError(e,s.Errors.NO_SUCH_FILE,o)}},t.sleep={exec:function(e,t){var r=t.args,n=parseFloat(r[0]);return isNaN(n)&&(n=0),new Promise(function(t){return setTimeout(function(){return t(e)},1e3*n)})}}},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(2),s=n(i),c=r(1),u=r(3),l=n(u),f=r(6),p=n(f),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.commands=Object.assign(t,l),this.prevCommands=[],this.prevCommandsIndex=0}return a(e,[{key:"pushInput",value:function(e,t){return this.prevCommands.push(e),this.prevCommandsIndex=this.prevCommands.length,Object.assign({},t,{history:t.history.concat({cwd:t.cwd,value:e})})}},{key:"execute",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=p.parse(e);return this.runCommands(n,t,r)}},{key:"runCommands",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=!1,o=Object.assign({},t),a=function(e,t){return e.catch(function(e){n=!0;var r=e&&e.message?e.message:"command "+t.name+" failed";return s.appendError(o,"$1",r)}).then(function(e){return n=n||e&&e.error,o=e,e})},i=this,u=regeneratorRuntime.mark(function t(){var r,u,l,f,p,h,d,v,y,m,b,g,x,O,E,w,_,j,P;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,u=!1,l=void 0,t.prev=3,f=e[Symbol.iterator]();case 5:if(r=(p=f.next()).done){t.next=78;break}h=p.value,d=!0,v=!1,y=void 0,t.prev=10,m=h[Symbol.iterator]();case 12:if(d=(b=m.next()).done){t.next=61;break}if(g=b.value,!n){t.next=16;break}return t.abrupt("break",61);case 16:if(""!==g.name){t.next=20;break}return t.next=19,Promise.resolve(o);case 19:return t.abrupt("continue",58);case 20:if(i.commands[g.name]){t.next=26;break}return n=!0,o=s.appendError(o,c.Errors.COMMAND_NOT_FOUND,g.name),t.next=25,Promise.resolve(o);case 25:return t.abrupt("continue",58);case 26:if(x=i.commands[g.name].exec(o,g),!x||"function"!=typeof x[Symbol.iterator]){t.next=56;break}O=!0,E=!1,w=void 0,t.prev=31,_=x[Symbol.iterator]();case 33:if(O=(j=_.next()).done){t.next=40;break}return P=j.value,t.next=37,a(Promise.resolve(P),g);case 37:O=!0,t.next=33;break;case 40:t.next=46;break;case 42:t.prev=42,t.t0=t.catch(31),E=!0,w=t.t0;case 46:t.prev=46,t.prev=47,!O&&_.return&&_.return();case 49:if(t.prev=49,!E){t.next=52;break}throw w;case 52:return t.finish(49);case 53:return t.finish(46);case 54:t.next=58;break;case 56:return t.next=58,a(Promise.resolve(x),g);case 58:d=!0,t.next=12;break;case 61:t.next=67;break;case 63:t.prev=63,t.t1=t.catch(10),v=!0,y=t.t1;case 67:t.prev=67,t.prev=68,!d&&m.return&&m.return();case 70:if(t.prev=70,!v){t.next=73;break}throw y;case 73:return t.finish(70);case 74:return t.finish(67);case 75:r=!0,t.next=5;break;case 78:t.next=84;break;case 80:t.prev=80,t.t2=t.catch(3),u=!0,l=t.t2;case 84:t.prev=84,t.prev=85,!r&&f.return&&f.return();case 87:if(t.prev=87,!u){t.next=90;break}throw l;case 90:return t.finish(87);case 91:return t.finish(84);case 92:case"end":return t.stop()}},t,this,[[3,80,84,92],[10,63,67,75],[31,42,46,54],[47,,49,53],[68,,70,74],[85,,87,91]])})(),l=function e(){var t=u.next(),n=t.value,a=t.done;return a?Promise.resolve(o):n.then(function(e){return r(e)}).then(function(){return e(u)})};return l()}},{key:"autocomplete",value:function(e,t){var r=t.structure,n=t.cwd,o=e.split(/ +/),a=o.pop(),i=function(e){return 0===e.indexOf(a)},c=function(e){return o.concat(e).join(" ")};if(0===o.length){var u=Object.keys(this.commands).filter(i);return 1===u.length?c(u[0]):null}var l=a.split("/");a=l.pop();var f=l.join("/"),p=s.extractPath(f,n),h=s.getDirectoryByPath(r,p),d=h.err,v=h.dir;if(d)return null;var y=Object.keys(v).filter(i),m=f?f+"/":"";return 1===y.length?c(""+m+y[0]):null}},{key:"getPrevCommand",value:function(){return this.prevCommands[--this.prevCommandsIndex]}},{key:"getNextCommand",value:function(){return this.prevCommands[++this.prevCommandsIndex]}},{key:"hasPrevCommand",value:function(){return 0!==this.prevCommandsIndex}},{key:"hasNextCommand",value:function(){return this.prevCommandsIndex!==this.prevCommands.length-1}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(8),l=o(u),f=r(3),p=n(f),h=r(4),d=o(h),v=r(7),y=o(v),m=17,b=76,g=67,x=38,O=40,E=9,w=function(){},_=function(e){function t(e){var r=e.history,n=e.structure,o=e.extensions,s=e.prefix;a(this,t);var c=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return c.Bash=new d.default(o),c.ctrlPressed=!1,c.state={settings:{user:{username:s.split("@")[1]}},history:r.slice(),structure:Object.assign({},n),cwd:"",isBusy:!1,bashExecutionsObserver:null},c.handleKeyDown=c.handleKeyDown.bind(c),c.handleKeyUp=c.handleKeyUp.bind(c),c}return s(t,e),c(t,[{key:"componentDidMount",value:function(){this.refs.input.focus()}},{key:"componentWillReceiveProps",value:function(e){var t=e.extensions,r=e.structure,n=e.history,o={};r&&(o.structure=Object.assign({},r)),n&&(o.history=n.slice()),t&&(this.Bash.commands=Object.assign({},t,p)),this.setState(o)}},{key:"shouldComponentUpdate",value:function(e,t){return this.state!==t||this.props!==e}},{key:"componentDidUpdate",value:function(){this.refs.input.scrollIntoView()}},{key:"attemptAutocomplete",value:function(){var e=this.refs.input.value,t=this.Bash.autocomplete(e,this.state);t&&(this.refs.input.value=t)}},{key:"handleKeyDown",value:function(e){e.which===m?this.ctrlPressed=!0:e.which===E&&(this.attemptAutocomplete(),e.preventDefault())}},{key:"handleKeyUp",value:function(e){var t=this;if(e.which===b){if(this.ctrlPressed){var r=this.Bash.execute("clear",this.state).then(function(e){return new Promise(function(r){t.setState(e,r)})});this.props.observeBashExecutions&&this.setState({bashExecutionsObserver:r})}}else e.which===g?this.ctrlPressed&&(this.refs.input.value=""):e.which===x?this.Bash.hasPrevCommand()&&(this.refs.input.value=this.Bash.getPrevCommand()):e.which===O?this.refs.input.value=this.Bash.hasNextCommand()?this.Bash.getNextCommand():"":e.which===m&&(this.ctrlPressed=!1)}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var r=e.target[0].value;this.setState(Object.assign({},this.Bash.pushInput(r,this.state),{isBusy:!0}),function(){t.refs.input.value="";var e=t.Bash.execute(r,t.state,function(e){return new Promise(function(r){t.setState(e,r)})}).then(function(e){return new Promise(function(r){t.setState(Object.assign({},e,{isBusy:!1}),r)})});t.props.observeBashExecutions&&t.setState({bashExecutionsObserver:e})})}},{key:"renderHistoryItem",value:function(e){var t=this;return function(r,n){var o=r.hasOwnProperty("cwd")?l.default.createElement("span",{style:e.prefix},t.props.prefix+" ~"+r.cwd+" $"):void 0;return l.default.createElement("div",{"data-test-id":"history-"+n,key:n},o,r.value)}}},{key:"render",value:function(){var e=this,t=this.props,r=t.onClose,n=t.onExpand,o=t.onMinimize,a=t.prefix,i=t.theme,s=this.state,c=s.history,u=s.cwd,f=y.default[i]||y.default.light,p=Object.assign({},f.form);return this.state.isBusy&&(p.display="none"),l.default.createElement("div",{className:"ReactBash",style:f.ReactBash},l.default.createElement("div",{style:f.header},l.default.createElement("span",{style:f.redCircle,onClick:r}),l.default.createElement("span",{style:f.yellowCircle,onClick:o}),l.default.createElement("span",{style:f.greenCircle,onClick:n})),l.default.createElement("div",{style:f.body,onClick:function(){return e.refs.input.focus()}},c.map(this.renderHistoryItem(f)),l.default.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)},style:p},l.default.createElement("span",{style:f.prefix},a+" ~"+u+" $"),l.default.createElement("input",{autoComplete:"off",onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,ref:"input",style:f.input}))))}}]),t}(u.Component);t.default=_,_.Themes={LIGHT:"light",DARK:"dark"},_.propTypes={extensions:u.PropTypes.object,history:u.PropTypes.array,onClose:u.PropTypes.func,onExpand:u.PropTypes.func,onMinimize:u.PropTypes.func,prefix:u.PropTypes.string,structure:u.PropTypes.object,theme:u.PropTypes.string,observeBashExecutions:u.PropTypes.bool},_.defaultProps={extensions:{},history:[],onClose:w,onExpand:w,onMinimize:w,prefix:"hacker@default",structure:{},theme:_.Themes.LIGHT,observeBashExecutions:!1}},function(e,t){"use strict";function r(e){for(var t=e.split(/ +/),r=t.shift(),n={},o={},a=0;t.length>0;){var i=t.shift();if("-"===i[0])if("-"===i[1]){var s=t.shift();o[i.slice(2)]=s}else i.slice(1).split("").forEach(function(e){n[e]=!0});else o[a++]=i}return{name:r,flags:n,input:e,args:o}}function n(e){return e.trim().split(/ *&& */).map(function(e){return e.split(/ *; */).map(r)})}Object.defineProperty(t,"__esModule",{value:!0}),t.parseInput=r,t.parse=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};r.ReactBash={borderRadius:"5px",display:"flex",flexDirection:"column",fontFamily:"'Inconsolata', monospace",fontSize:"13px",fontWeight:"400",height:"100%",overflow:"hidden",textAlign:"left"},r.header={padding:"5px 10px 0"};var n={borderRadius:"50%",display:"inline-block",height:"15px",marginRight:"5px",width:"15px"};r.redCircle=Object.assign({},n,{backgroundColor:"#bf616a"}),r.yellowCircle=Object.assign({},n,{backgroundColor:"#ebcb8b"}),r.greenCircle=Object.assign({},n,{backgroundColor:"#a3be8c"}),r.body={flexGrow:1,overflowY:"scroll",padding:"10px"},r.form={display:"flex"},r.input={background:"none",border:"none",color:"inherit",flexGrow:"1",fontFamily:"inherit",fontSize:"inherit",outline:"none !important",padding:0},r.prefix={marginRight:"5px"},t.default={light:Object.assign({},r,{body:Object.assign({},r.body,{backgroundColor:"#fff",color:"#5D5D5D"}),header:Object.assign({},r.header,{backgroundColor:"#eee"}),prefix:Object.assign({},r.prefix,{color:"#bd081c"})}),dark:Object.assign({},r,{body:Object.assign({},r.body,{backgroundColor:"#000",color:"#d0d0d0"}),header:Object.assign({},r.header,{backgroundColor:"#dcdbdb"}),prefix:Object.assign({},r.prefix,{color:"#5b65fb"})})}},function(t,r){t.exports=e}])});